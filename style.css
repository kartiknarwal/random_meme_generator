:root{
  --bg1: #eaf2ff;
  --bg2: #ffe9f3;
  --accent1: #5c7aea;
  --accent2: #f7a9a8;
  --glass: rgba(255,255,255,0.65);
  --muted: #666;
  --text: #212121;
  --radius: 14px;
}

/* Dark neon theme vars (swapped when .theme-dark added) */
body.theme-dark { --bg1: #071026; --bg2:#0f1026; --accent1: #6be0ff; --accent2:#ff6bcb; --glass: rgba(12,12,20,0.6); --text:#eaeaea; --muted:#b9b9c5; }

*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',system-ui,Segoe UI,Roboto,Helvetica,Arial;}

body{
  min-height:100vh;
  background: linear-gradient(135deg,var(--bg1),var(--bg2));
  color:var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:24px;
}

/* Topbar */
.topbar{
  width:100%;
  max-width:1100px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:18px;
  gap:12px;
}
.brand{display:flex;gap:14px;align-items:center}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:24px;box-shadow:0 8px 30px rgba(92,122,234,0.18);}
.title h1{font-size:20px;letter-spacing:0.2px;margin-bottom:2px}
.title .tag{font-size:12px;color:var(--muted)}

/* top actions */
.top-actions{display:flex;align-items:center;gap:10px}
.icon-btn{background:transparent;border:none;padding:8px;border-radius:8px;cursor:pointer;font-size:16px}
.icon-btn:hover{transform:translateY(-2px)}

/* theme switch */
.theme-switch{position:relative;width:46px;height:28px;display:inline-block}
.theme-switch input{display:none}
.switch-track{position:absolute;inset:0;border-radius:999px;background:linear-gradient(90deg,#e6eaff,#ffdbe6);box-shadow:inset 0 1px 0 rgba(255,255,255,0.6)}
.theme-switch input:checked + .switch-track{background:linear-gradient(90deg,var(--accent1),var(--accent2))}

/* glass base */
.glass{
  background:var(--glass);
  border-radius:var(--radius);
  padding:12px;
  box-shadow: 0 6px 24px rgba(12,12,20,0.06);
  backdrop-filter: blur(6px) saturate(120%);
}

/* controls */
.app{width:100%;max-width:1100px}
.controls{display:flex;justify-content:space-between;gap:12px;align-items:center;margin-bottom:18px}
.controls .left{display:flex;gap:12px;align-items:center}
select{padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);min-width:180px}
.btn-row{display:flex;gap:8px}
button.primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600;box-shadow:0 8px 18px rgba(92,122,234,0.14);transition:transform .18s ease}
button.primary:hover{transform:translateY(-3px)}
button.muted{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:10px 12px;border-radius:10px;cursor:pointer}

.controls .right{display:flex;flex-direction:column;gap:8px;align-items:flex-end}
.caption-controls{display:flex;gap:8px}
.caption-controls input{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);min-width:180px}
.small-actions{display:flex;gap:8px}
.outline{background:transparent;border:1px solid rgba(0,0,0,0.08);padding:8px 10px;border-radius:8px;cursor:pointer}

/* meme area */
.meme-area{display:grid;grid-template-columns:1fr 320px;gap:18px;align-items:start}
.meme-card{padding:18px;display:flex;flex-direction:column;gap:12px;align-items:stretch;min-height:420px}
.loader{display:flex;flex-direction:column;align-items:center;gap:8px;padding:18px}
.loader-emoji{font-size:28px;animation:pop 1s infinite}
@keyframes pop{0%{transform:translateY(0)}50%{transform:translateY(-8px)}100%{transform:translateY(0)}}
.loader-text{font-size:13px;color:var(--muted)}

.image-wrap{position:relative;border-radius:12px;overflow:hidden;background:linear-gradient(180deg,rgba(0,0,0,0.02),rgba(0,0,0,0.01));display:flex;justify-content:center;align-items:center;min-height:260px}
.meme-image{max-width:100%;max-height:520px;display:block;opacity:0;transition:opacity .35s ease, transform .35s ease;transform:scale(.98)}
.meme-image.visible{opacity:1;transform:scale(1)}

.meme-canvas{width:100%;height:auto;border-radius:12px;display:block}

.caption-overlay{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:space-between;padding:18px;pointer-events:none}
.overlay-text{font-weight:800;text-align:center;text-transform:uppercase;padding:6px 10px;font-size:22px;letter-spacing:1px;filter:drop-shadow(0 2px 3px rgba(0,0,0,0.35));color:#fff}
.overlay-text.top{align-self:center;margin-top:6px}
.overlay-text.bottom{align-self:center;margin-bottom:6px}

/* meta */
.meta-row{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:6px}
.meme-author{color:var(--muted)}
.subreddit{font-size:12px;color:var(--muted)}

/* joke card */
.joke-card{padding:18px;min-height:180px}
.joke-card h3{margin-bottom:10px}
.joke-card p{color:var(--muted)}

/* favorites modal */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(2,6,23,0.4),rgba(2,6,23,0.6));z-index:60}
.modal[aria-hidden="false"]{display:flex}
.modal-panel{width:90%;max-width:900px;padding:18px;border-radius:12px}
.modal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.favorites-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px;max-height:60vh;overflow:auto;padding-bottom:6px}
.fav-item{position:relative;border-radius:10px;overflow:hidden}
.fav-img{width:100%;height:120px;object-fit:cover;display:block}
.fav-overlay{position:absolute;inset:0;background:linear-gradient(180deg,transparent,rgba(0,0,0,0.35));display:flex;gap:6px;align-items:flex-end;justify-content:center;padding:8px;opacity:0;transition:opacity .18s}
.fav-item:hover .fav-overlay{opacity:1}
.fav-overlay button{background:rgba(255,255,255,0.12);border:none;padding:6px 8px;border-radius:8px;color:white;cursor:pointer}

/* footer & responsiveness */
.footer-actions{max-width:1100px;width:100%;margin-top:14px;text-align:center;color:var(--muted)}
.sr-only{position:absolute;left:-9999px}

/* small screens */
@media (max-width:920px){
  .meme-area{grid-template-columns:1fr}
  .controls{flex-direction:column;align-items:stretch}
  .controls .right{align-items:stretch}
}
